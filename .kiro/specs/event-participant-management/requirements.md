# イベント参加者管理システム 要件定義書

## 概要

イベント参加者管理システムは、Googleスプレッドシートをデータソースとして使用し、イベント参加者のチェックインと管理者による監督機能を提供するフロントエンドアプリケーションです。既存のGoogleフォーム回答シートと連携し、イベント中の参加者追跡と管理をリアルタイムで実現します。

## 用語集

- **システム**: イベント参加者管理システム
- **回答シート**: Googleフォームの回答を含むGoogleスプレッドシート文書
- **管理者**: 参加者一覧とシステム設定への完全なアクセス権を持つユーザー
- **参加者**: イベント登録のためにGoogleフォーム回答を提出し、自身でチェックインを行う個人
- **システム列**: 追跡目的でシステムが回答シートに追加する追加列
- **チェックイン処理**: 参加者をイベント出席済みとしてマークする操作
- **氏名照合**: 入力と保存された参加者氏名間の完全文字列比較
- **監査証跡**: タイムスタンプとユーザー情報を含むすべてのシステム操作の記録

## 要件

### 要件1

**ユーザーストーリー:** 管理者として、Googleスプレッドシート接続を設定したい。これにより、システムが既存のGoogleフォーム回答から参加者データにアクセスできるようになる。

#### 受入基準

1. システムは管理者からのGoogleスプレッドシートURL入力を受け付けること
2. 管理者が回答シートURLを提供した時、システムは読み書き権限を確認する接続テストを実行すること
3. 接続テストが失敗した場合、システムは具体的な権限問題を示すエラーメッセージを表示すること
4. 接続テストが成功した時、システムは回答シートにシステム列を追加する前に管理者の同意を求めること
5. 管理者が同意を与えた場合、システムは必要なシステム列を回答シートに追加すること

### 要件2

**ユーザーストーリー:** 参加者として、自分の氏名を入力してセルフチェックインしたい。これにより、他の参加者情報を見ることなく効率的に入場処理ができる。

#### 受入基準

1. システムは参加者に氏名入力フィールドを提供すること
2. 参加者が自分の氏名を入力した時、システムは回答シートに対して完全氏名照合を実行すること
3. 完全氏名照合が見つからない場合、システムは「参加者が見つかりません」メッセージを表示すること
4. 完全氏名照合が正確に1件見つかった場合、システムは氏名、登録状況、チェックイン状況を含む参加者の最小情報を表示すること
5. システムは、まだチェックインしていない一致した参加者を表示する時、チェックインボタンを提供すること
6. 参加者がチェックインボタンをクリックした時、システムは回答シート内の参加者のチェックイン状況を更新すること
7. システムは、既にチェックイン済みの参加者の重複チェックインを防止すること

### 要件3

**ユーザーストーリー:** 参加者として、間違ってチェックインした場合に取り消したい。これにより、チェックイン処理中に発生した間違いを修正できる。

#### 受入基準

1. 参加者がチェックイン処理を完了した時、システムは限定時間内に取り消しボタンを表示すること
2. 参加者が時間制限内に取り消しボタンをクリックした時、システムは回答シート内のチェックイン状況を元に戻すこと
3. システムは監査証跡にすべての取り消し操作を記録すること
4. システムは時間制限が過ぎた後、取り消しボタンを無効にすること

### 要件4

**ユーザーストーリー:** 管理者として、すべての参加者情報を表示・管理したい。これにより、イベント出席を監視し、必要に応じてデータをエクスポートできる。

#### 受入基準

1. システムは回答シートからすべての参加者記録を管理者に表示すること
2. システムは参加者氏名とメールアドレスの検索機能を提供すること
3. システムはチェックイン状況に基づくフィルタリングオプションを提供すること
4. システムは氏名、登録タイムスタンプ、チェックインタイムスタンプによる並び替えを許可すること
5. システムは現在のフィルタリングビューのCSVエクスポート機能を提供すること
6. システムは元のGoogleフォーム回答データの編集を防止すること
7. システムはチェックイン情報を含むシステム列データの表示を許可すること

### 要件5

**ユーザーストーリー:** システムユーザーとして、信頼性のあるデータ同期を求める。これにより、ネットワーク中断中でも参加者情報が正確に保たれる。

#### 受入基準

1. チェックイン処理中にネットワーク接続が失われた時、システムは操作をローカルに保存すること
2. ネットワーク接続が復旧した時、システムは保留中の操作を回答シートと自動同期すること
3. システムは更新前にタイムスタンプ値を比較してデータ競合を防止すること
4. データ競合が検出された場合、システムはユーザーに更新と再試行を促すこと
5. システムは最大5000人の参加者に対して3秒以内に参加者一覧の読み込みを完了すること

### 要件6

**ユーザーストーリー:** システムユーザーとして、参加者データへの安全なアクセスを求める。これにより、プライバシーとデータ保護要件が満たされる。

#### 受入基準

1. システムはGoogle OAuth 2.0を通じてユーザーを認証すること
2. システムは必要最小限のGoogle Sheets API権限のみを要求すること
3. システムはすべてのデータ送信にHTTPSを使用すること
4. システムは認証トークンを永続的に保存しないこと
5. システムはユーザー識別とタイムスタンプを含むすべてのデータ変更操作を監査証跡に記録すること
6. システムは参加者のアクセスを自分自身のチェックイン操作のみに制限すること
7. システムはGoogleスプレッドシート共有権限に従って管理者アクセスを制限すること

### 要件7

**ユーザーストーリー:** 管理者として、参加者氏名を含む列を設定したい。これにより、システムが異なるGoogleフォーム構造で動作できる。

#### 受入基準

1. システムは管理者が参加者氏名を含む回答シート列を選択することを許可すること
2. システムは設定を保存する前に、選択された列にデータが含まれていることを検証すること
3. 管理者が氏名列マッピングを変更した時、システムはそれに応じて氏名照合ロジックを更新すること
4. システムは確認のために選択された列からの参加者氏名のプレビューを表示すること

### 要件8

**ユーザーストーリー:** システム管理者として、包括的な監査ログを求める。これにより、すべてのシステム操作を追跡・確認できる。

#### 受入基準

1. システムはすべてのチェックイン処理操作のタイムスタンプを記録すること
2. システムはすべてのデータ変更のユーザー識別を記録すること
3. システムは追加の操作コンテキストのための監査メモフィールドを維持すること
4. システムはすべての回答シート変更について最終更新タイムスタンプとユーザーを更新すること
5. システムはCSVへのデータエクスポート時に監査情報を保持すること